<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shaka Smart Player</title>

<!-- Shaka Player -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.5/shaka-player.compiled.js"></script>

<style>
    html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        background: #000;
        overflow: hidden;
    }

    #videoContainer {
        position: fixed;
        inset: 0;
        background: #000;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    video {
        width: 100%;
        height: 100%;
        object-fit: contain; /* Kesme yok, taşma yok */
        background: #000;
    }
</style>

</head>
<body>

<div id="videoContainer">
    <video id="video" autoplay controls playsinline></video>
</div>

<script>
const PLAYLIST_URL = "https://utay88.github.io/Utay88/live/trt1.m3u8";

async function loadStream() {
    const res = await fetch(PLAYLIST_URL + "?t=" + Date.now());
    return (await res.text()).trim();
}

async function start() {
    const video = document.getElementById('video');
    const stream = await loadStream();

    if (!stream) {
        alert("Yayın alınamadı.");
        return;
    }

    if (shaka.Player.isBrowserSupported()) {
        const player = new shaka.Player(video);

        // En yüksek kaliteyi sabitle
        player.getConfiguration().abr = {
            enabled: false
        };

        player.load(stream).then(() => {
            console.log("Yayın açıldı:", stream);
        }).catch(error => {
            console.error("Shaka hata:", error);
        });

    } else {
        alert("Tarayıcı Shaka desteklemiyor!");
    }
}

start();
</script>

</body>
</html>
