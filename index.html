<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Full HD Player</title>

<!-- Plyr CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/plyr@3/dist/plyr.css" />

<style>
    body {
        margin: 0;
        background: #000;
        overflow: hidden;
    }

    video {
        width: 100vw;
        height: 100vh;
        object-fit: contain;   /* HER CİHAZDA DOĞRU ORAN */
        background: #000;
    }
</style>
</head>
<body>

<video id="player" playsinline controls></video>

<!-- HLS.js -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<!-- Plyr JS -->
<script src="https://cdn.jsdelivr.net/npm/plyr@3/dist/plyr.polyfilled.js"></script>

<script>
    const streamUrl = "live/trt1.m3u8?t=" + Date.now(); 
    const video = document.getElementById("player");

    // Plyr başlat
    const player = new Plyr(video, {
        clickToPlay: false,    // EKRANA TIKLAYINCA DURMA ❗
        keyboard: { focused: true, global: true },
        autoplay: true
    });

    if (Hls.isSupported()) {
        const hls = new Hls({
            maxBufferLength: 30,
            enableWorker: true
        });

        hls.loadSource(streamUrl);
        hls.attachMedia(video);

        // *** EN YÜKSEK KALİTEYİ SEÇ ***
        hls.on(Hls.Events.MANIFEST_PARSED, function () {
            let max = hls.levels.length - 1;
            hls.currentLevel = max;  // **HER ZAMAN EN YÜKSEK KALİTE**
            video.play();
        });

        // *** Hata olursa toparla ***
        hls.on(Hls.Events.ERROR, function (event, data) {
            if (data.fatal) {
                if (data.type === Hls.ErrorTypes.NETWORK_ERROR) {
                    hls.startLoad();
                } else if (data.type === Hls.ErrorTypes.MEDIA_ERROR) {
                    hls.recoverMediaError();
                }
            }
        });
    } else if (video.canPlayType("application/vnd.apple.mpegurl")) {
        video.src = streamUrl;
        video.play();
    }
</script>

</body>
</html>
