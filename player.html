<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CanlÄ± YayÄ±n</title>

<style>
body { margin:0; background:black; overflow:hidden; }

#videoContainer {
  position:fixed;
  top:0; left:0;
  width:100%;
  height:100%;
  background:black;
}

#player {
  width:100%;
  height:100%;
  object-fit:contain;
}

/* ALT BAR */
#controls {
  position:absolute;
  bottom:0;
  left:0;
  width:100%;
  padding:8px 12px;
  display:flex;
  align-items:center;
  gap:10px;
  background:rgba(0,0,0,0.40);
  transition:opacity .4s;
  opacity:0;
}

#controls.show {
  opacity:1;
}

.liveDot {
  width:10px; height:10px;
  border-radius:50%;
  background:red;
}

.liveText {
  color:white;
  font-size:16px;
  font-weight:bold;
}

#progress {
  flex:0 0 75%;
}

#progress input {
  width:100%;
}

.ctrlBtn {
  color:white;
  font-size:26px;
  cursor:pointer;
  padding:4px;
}
</style>
</head>

<body>

<div id="videoContainer">

  <video id="player" playsinline></video>

  <div id="controls">
      <div class="liveDot"></div>
      <div class="liveText">LIVE</div>

      <div id="progress">
          <input type="range" id="seek" min="0" max="100" value="0">
      </div>

      <div id="muteBtn" class="ctrlBtn">ðŸ”Š</div>
      <div id="fsBtn" class="ctrlBtn">â›¶</div>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
const kontrolURL = "https://raw.githubusercontent.com/Utay88/Utay88/main/kontrol.json";

let video = document.getElementById("player");
let controls = document.getElementById("controls");
let seek = document.getElementById("seek");
let fsBtn = document.getElementById("fsBtn");
let muteBtn = document.getElementById("muteBtn");

let hls;
let hideTimer;
let currentStream = "";

/* --- JSON YAYIN KONTROLÃœ --- */
function checkStream() {
    fetch(kontrolURL + "?t=" + Date.now())
    .then(r=>r.json())
    .then(data=>{
        if(data.yayin && data.yayin !== currentStream){
            currentStream = data.yayin;
            loadStream(currentStream);
        }
    });
}

setInterval(checkStream, 2000);
checkStream();

/* --- STREAM YÃœKLEME --- */
function loadStream(url){
  if(hls){ hls.destroy(); hls=null; }

  if(Hls.isSupported()){
      hls = new Hls({
          maxMaxBufferLength:60,
          liveSyncDuration:4,
          liveDurationInfinity:true
      });

      hls.loadSource(url);
      hls.attachMedia(video);

  } else {
      video.src = url;
  }

  video.play();
}

/* --- KONTROLLERÄ° OTOMATÄ°K SAKLA --- */
function showControls(){
  controls.classList.add("show");
  clearTimeout(hideTimer);
  hideTimer = setTimeout(()=>controls.classList.remove("show"), 3000);
}

document.addEventListener("mousemove", showControls);
document.addEventListener("touchstart", showControls);

/* --- SEEKBAR --- */
video.addEventListener("timeupdate",()=>{
    if(!video.duration) return;
    seek.value = (video.currentTime / video.duration) * 100;
});

seek.addEventListener("input",()=>{
    video.currentTime = (seek.value / 100) * video.duration;
});

/* --- SES --- */
muteBtn.onclick = ()=>{
  video.muted = !video.muted;
  muteBtn.textContent = video.muted ? "ðŸ”‡" : "ðŸ”Š";
};

/* --- TAM EKRAN --- */
fsBtn.onclick = ()=>{
  if(!document.fullscreenElement){
      video.requestFullscreen();
  } else {
      document.exitFullscreen();
  }
};
</script>

</body>
</html>
