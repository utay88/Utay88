<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CanlÄ± YayÄ±n</title>

<style>
body { margin:0; background:black; overflow:hidden; }
#videoContainer { width:100vw; height:100vh; position:relative; background:black; }
video { width:100%; height:100%; object-fit:contain; background:black; }

#controls {
    position:absolute; bottom:0; left:0;
    width:100%; height:55px;
    background:rgba(0,0,0,0.55);
    display:flex; align-items:center;
    padding:0 12px;
    opacity:0; transition:opacity .3s;
    box-sizing:border-box;
}

#liveTag {
    color:white; font-size:15px; display:flex; align-items:center;
    margin-right:10px; flex-shrink:0;
}
#liveTag::before {
    content:""; width:10px; height:10px; background:red;
    border-radius:50%; margin-right:6px; display:inline-block;
}

#progress { flex:1; margin:0 12px; min-width:0; }
#progress input { width:100%; display:block }

#volumeBtn, #fsBtn, #qualityBtn {
    font-size:22px; color:white;
    margin-left:10px;
    cursor:pointer; flex-shrink:0;
    font-weight:bold;
}

#qualityMenu {
    position:absolute;
    bottom:60px;
    right:20px;
    background:rgba(0,0,0,0.85);
    padding:8px 12px;
    border-radius:6px;
    display:none;
}
.qItem {
    color:white;
    padding:6px 0;
    cursor:pointer;
    font-size:16px;
}
.qItem:hover { opacity:0.6; }
</style>
</head>
<body>

<div id="videoContainer">
    <video id="player" autoplay playsinline></video>

    <div id="controls">
        <div id="liveTag">LIVE</div>

        <div id="progress">
            <input type="range" id="seek" min="0" max="100">
        </div>

        <div id="qualityBtn">HD</div>
        <div id="volumeBtn">ðŸ”Š</div>
        <div id="fsBtn">â›¶</div>
    </div>

    <div id="qualityMenu">
        <div class="qItem" data-q="360">360p</div>
        <div class="qItem" data-q="480">480p</div>
        <div class="qItem" data-q="720">720p</div>
        <div class="qItem" data-q="1080">1080p</div>
        <div class="qItem" data-q="1440">1440p</div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
/* ================================================
   âœ” KANAL ADI â€” HER HTML SAYFASINDA BUNU DEÄžÄ°ÅžTÄ°R!
================================================ */
const kanalAdi = "trtspor";  // Ã–rnek â€” her sayfada kendine gÃ¶re deÄŸiÅŸtir

/* ================================================ */
const kontrolURL = "https://raw.githubusercontent.com/Utay88/Utay88/main/kontrol.json";
let video = document.getElementById("player");
let controls = document.getElementById("controls");
let qualityMenu = document.getElementById("qualityMenu");
let seek = document.getElementById("seek");
let hideTimer;
let hls;
let currentStream = "";

/* ================================================
   âœ” ALT BAR OTOMATÄ°K GÄ°ZLENME
================================================ */
function showControls() {
    controls.style.opacity = 1;
    clearTimeout(hideTimer);
    hideTimer = setTimeout(() => {
        controls.style.opacity = 0;
    }, 3000);
}
document.body.addEventListener("mousemove", showControls);
document.body.addEventListener("click", showControls);

/* ================================================
   âœ” YAYINI YÃœKLE
================================================ */
function loadStream(url) {
    if (hls) hls.destroy();
    video.src = "";

    if (Hls.isSupported()) {
        hls = new Hls({
            maxMaxBufferLength:20
        });

        hls.loadSource(url);
        hls.attachMedia(video);

        hls.on(Hls.Events.MANIFEST_PARSED, function (event, data) {
            if (data.levels && data.levels.length > 0) {
                let highest = data.levels.length - 1;
                hls.currentLevel = highest;
            }
            video.play();
        });

        hls.on(Hls.Events.LEVEL_SWITCHING, function () {
            hls.nextLevel = hls.levels.length - 1;
        });

    } else {
        video.src = url;
        video.play();
    }
}

/* ================================================
   âœ” JSON'DAN YAYIN TAKÄ°P
================================================ */
function checkStream() {
    fetch(kontrolURL + "?t=" + Date.now())
        .then(r => r.json())
        .then(d => {
            let link = d.kanallar[kanalAdi];
            if (link && link !== currentStream) {
                currentStream = link;
                loadStream(currentStream);
            }
        });
}
setInterval(checkStream, 3000);
checkStream();

/* ================================================
   âœ” SEEK BAR
================================================ */
video.addEventListener("timeupdate", () => {
    if (!video.duration) return;
    seek.value = (video.currentTime / video.duration) * 100;
});
seek.addEventListener("input", () => {
    video.currentTime = (seek.value / 100) * video.duration;
});

/* ================================================
   âœ” SES BUTONU
================================================ */
document.getElementById("volumeBtn").onclick = () => {
    video.muted = !video.muted;
};

/* ================================================
   âœ” TAM EKRAN
================================================ */
document.getElementById("fsBtn").onclick = () => {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
    } else {
        document.exitFullscreen();
    }
};

/* ================================================
   âœ” QUALITY (HD) BUTONU
================================================ */
let qualityBtn = document.getElementById("qualityBtn");
let qualityTimer;

qualityBtn.onclick = () => {
    qualityMenu.style.display = "block";
    clearTimeout(qualityTimer);
    qualityTimer = setTimeout(() => {
        qualityMenu.style.display = "none";
    }, 3000);
};

document.querySelectorAll(".qItem").forEach(item => {
    item.onclick = () => {
        let q = item.getAttribute("data-q");

        if (hls && hls.levels) {
            let index = hls.levels.findIndex(l => l.height == q);
            if (index !== -1) hls.currentLevel = index;
        }

        qualityMenu.style.display = "none";
    };
});

/* ================================================
   âœ” ESC / BACK TUÅžU TAM GARANTÄ°
================================================ */
document.addEventListener("keydown", function(e) {
    if (e.key === "Escape" || e.key === "Backspace") {
        if (document.fullscreenElement) {
            document.exitFullscreen();
            return;
        }
        if (history.length > 1) {
            history.back();
        }
    }
});
</script>

</body>
</html>
