<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Canlı Yayın</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body { margin:0; background:black; }
  #player { width:100%; height:100vh; }
</style>

<!-- Clappr -->
<script src="https://cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js"></script>

<!-- Çözünürlük seçici -->
<script src="https://cdn.jsdelivr.net/npm/clappr-level-selector-plugin@latest/dist/level-selector.min.js"></script>

</head>
<body>

<div id="player"></div>

<script>

// YAYINI BURADAN OKUYOR
const kontrolURL = "https://raw.githubusercontent.com/Utay88/Utay88/main/kontrol.json";

let current = "";
let player = null;

function loadStream(url){
    if(player) player.destroy();

    player = new Clappr.Player({
        parentId: "#player",
        source: url,
        autoPlay: true,
        width: "100%",
        height: "100%",
        plugins: [LevelSelector],
        levelSelectorConfig: {
            title: "Kalite",
            labels: { 0: "144p", 1: "240p", 2: "360p", 3: "480p", 4: "720p", 5: "1080p", 6: "1440p" }
        }
    });
}

function check(){
    fetch(kontrolURL + "?v=" + Date.now())
    .then(r => r.json())
    .then(data => {
        if(data.yayin && data.yayin !== current){
            current = data.yayin;
            loadStream(current);
        }
    });
}

check();
setInterval(check, 3000);

</script>

</body>
</html>
