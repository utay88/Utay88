<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CanlÄ± YayÄ±n</title>

<style>
body {
  margin:0;
  background:black;
  overflow:hidden;
}

video {
  width:100%;
  height:100vh;
  background:black;
  object-fit:contain;
}

#controls {
  position:absolute;
  bottom:0;
  width:100%;
  height:60px;
  background:rgba(0,0,0,0.45);
  display:flex;
  align-items:center;
  padding:8px;
  opacity:0;
  transition:opacity .3s;
}

#seek { width:100%; }
#volume { font-size:28px; color:white; margin-left:10px; }

#live {
  color:red;
  margin-right:10px;
  font-weight:bold;
}
</style>
</head>

<body>

<video id="player" autoplay playsinline></video>

<div id="controls">
  <div id="live">â— CANLI</div>
  <input type="range" id="seek" min="0" max="100" value="0">
  <div id="volume">ğŸ”Š</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
// JSON LÄ°NKÄ°N
const kontrolURL = "https://raw.githubusercontent.com/utay88/Utay88/main/kontrol.json";

let video = document.getElementById("player");
let controls = document.getElementById("controls");
let seek = document.getElementById("seek");
let hls = null;

// âœ” Kontrolleri otomatik gizle
let hideTimer;
function showControls(){
  controls.style.opacity = 1;
  clearTimeout(hideTimer);
  hideTimer = setTimeout(()=>{ controls.style.opacity = 0; }, 2000);
}
document.body.addEventListener("mousemove", showControls);

// âœ” JSON oku ve yayÄ±nÄ± baÅŸlat
async function loadJSON(){
  try {
    let res = await fetch(kontrolURL + "?t=" + Date.now());
    let data = await res.json();
    if(data.channel){
      loadStream(data.channel);
    }
  } catch(e){
    console.log("JSON okunamadÄ±:",e);
  }
}

// âœ” YayÄ±nÄ± yÃ¼kle
function loadStream(url){
  if(hls) {
    hls.destroy();
    hls = null;
  }

  if(Hls.isSupported()){
    hls = new Hls({
      maxMaxBufferLength: 2
    });

    hls.loadSource(url);
    hls.attachMedia(video);

    hls.on(Hls.Events.MANIFEST_PARSED, function(event, data){
      video.play();
    });

  } else {
    video.src = url;
    video.play();
  }
}

// âœ” Seek Ã§ubuÄŸu
seek.addEventListener("input", ()=>{
  if(video.duration){
    video.currentTime = video.duration * (seek.value / 100);
  }
});

// âœ” Otomatik gÃ¼ncelleme (5 saniyede bir JSON kontrol)
setInterval(loadJSON, 5000);

// âœ” Ä°lk aÃ§Ä±lÄ±ÅŸta JSON yÃ¼kle
loadJSON();
</script>

</body>
</html>
