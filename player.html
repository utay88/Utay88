<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CanlÄ± YayÄ±n</title>

<style>
    body { margin:0; background:black; overflow:hidden; }

    #videoContainer {
        position:fixed;
        top:0;
        left:0;
        width:100vw;
        height:100vh;
        background:black;
        overflow:hidden;
    }

    video {
        width:100%;
        height:100%;
        object-fit:contain;
        position:absolute;
        top:0;
        left:0;
    }

    /* ALT BAR */
    #controls {
        position:absolute;
        bottom:0;
        left:0;
        width:100%;
        height:55px;
        background:rgba(0,0,0,0.55);
        display:flex;
        align-items:center;
        padding:0 12px;
        opacity:0;
        transition:opacity .3s;
        pointer-events:auto;
    }

    /* LIVE */
    #liveTag {
        color:white;
        font-size:15px;
        display:flex;
        align-items:center;
        margin-right:10px;
    }
    #liveTag::before {
        content:"";
        width:10px;
        height:10px;
        background:red;
        border-radius:50%;
        margin-right:6px;
        display:inline-block;
    }

    /* Progress */
    #progress { flex:1; margin:0 12px; }
    #progress input { width:100%; }

    /* Ses & FS */
    .btn {
        font-size:28px;
        color:white;
        cursor:pointer;
        user-select:none;
        display:flex;
        align-items:center;
        justify-content:center;
        width:35px;
    }

    /* TAM EKRAN BUTONU YENÄ° */
    #fsBtn {
        font-size:30px;
        margin-left:8px;
        transform:translateY(0px);
    }
</style>
</head>

<body>

<div id="videoContainer">
    <video id="myVideo" playsinline autoplay></video>

    <div id="controls">
        <div id="liveTag">LIVE</div>

        <div id="progress">
            <input type="range" id="seekBar" min="0" max="100" value="100">
        </div>

        <div id="volumeBtn" class="btn">ðŸ”Š</div>
        <div id="fsBtn" class="btn">â›¶</div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
const kontrolURL = "https://raw.githubusercontent.com/Utay88/Utay88/main/kontrol.json";

let video = document.getElementById("myVideo");
let controls = document.getElementById("controls");
let seekBar = document.getElementById("seekBar");
let hls = null;
let currentStream = "";
let hideTimer;

/* ------------ ALT BAR GÃ–STER / GÄ°ZLE ------------ */
function showControls() {
    controls.style.opacity = 1;
    clearTimeout(hideTimer);
    hideTimer = setTimeout(()=> controls.style.opacity = 0, 3000);
}
document.body.onclick = showControls;

/* ------------ SES ------------ */
document.getElementById("volumeBtn").onclick = () => {
    video.muted = !video.muted;
};

/* ------------ TAM EKRAN ------------ */
document.getElementById("fsBtn").onclick = () => {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
    } else {
        document.exitFullscreen();
    }
};

/* ------------ YAYIN YÃœKLE ------------ */
function loadStream(url) {
    if (hls) {
        hls.destroy();
        hls = null;
    }

    if (Hls.isSupported()) {
        hls = new Hls({ autoStartLoad: true });
        hls.loadSource(url);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
    } else {
        video.src = url;
        video.play();
    }
}

/* ------------ JSON KONTROL ------------ */
function checkStream() {
    fetch(kontrolURL + "?t=" + Date.now())
    .then(r=>r.json())
    .then(data=>{
        if (data.yayin && data.yayin !== currentStream) {
            currentStream = data.yayin;
            loadStream(currentStream);
        }
    });
}

checkStream();
setInterval(checkStream, 3000);

/* ------------ SEEK ------------ */
seekBar.oninput = () => {
    if (!video.duration) return;
    let pos = seekBar.value / 100;
    video.currentTime = video.duration * pos;
};

video.ontimeupdate = () => {
    if (!video.duration) return;
    let p = (video.currentTime / video.duration) * 100;
    seekBar.value = p;
};
</script>

</body>
</html>
