<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Canlı Yayın</title>

<link
  rel="stylesheet"
  href="https://unpkg.com/@vime/core@5/themes/default.css"
/>

<style>
  body { margin:0; background:black; }
  vm-player { width:100%; height:100vh; }
</style>
</head>
<body>

<vm-player controls autoplay>
  <vm-hls id="source"></vm-hls>

  <vm-ui>
      <vm-controls full-width>
          <vm-control-group space="top">
              <vm-playback-control></vm-playback-control>
              <vm-volume-control></vm-volume-control>
              <vm-settings-control></vm-settings-control>
          </vm-control-group>
          <vm-scrubber-control></vm-scrubber-control>
      </vm-controls>
  </vm-ui>
</vm-player>

<script type="module">
import 'https://unpkg.com/@vime/core@5/dist/vime/vime.esm.js';

const kontrolURL = "https://raw.githubusercontent.com/Utay88/Utay88/main/kontrol.json";

let currentStream = "";
const source = document.getElementById("source");

function loadStream(url) {
  source.src = url;
}

function checkStream() {
  fetch(kontrolURL + "?t=" + Date.now())
    .then(r => r.json())
    .then(data => {
      if (data.yayin && data.yayin !== currentStream) {
        currentStream = data.yayin;
        loadStream(currentStream);
      }
    });
}

checkStream();
setInterval(checkStream, 3000);
</script>

</body>
</html>
