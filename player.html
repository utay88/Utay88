<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>TV Player</title>

<style>
body {margin:0;padding:0;background:#000;overflow:hidden;}
#player {width:100vw;height:100vh;position:fixed;top:0;left:0;}
</style>

<script src="https://cdn.jsdelivr.net/npm/@clappr/player@latest/dist/clappr.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/clappr/clappr-level-selector-plugin@latest/dist/level-selector.min.js"></script>

</head>
<body>

<div id="player"></div>

<script>
/* ================================
   JSON’dan yayın çeken TV Player
================================ */

const jsonURL = "https://raw.githubusercontent.com/utay88/Utay88/main/kontrol.json";

/* Çözünürlük LABEL DÜZELTME */
function fixedQualityLabel(level, label) {
    if (level && level.height) return level.height + "p";

    const map = {0:"360p",1:"480p",2:"720p",3:"1080p",4:"1440p"};
    if (typeof level?.index !== "undefined") return map[level.index] || "Otomatik";

    if (typeof level === "number") return map[level] || "Otomatik";

    return "Otomatik";
}

/* JSON’u OKU, PLAYER’I BAŞLAT */
fetch(jsonURL)
    .then(r => r.json())
    .then(data => {
        new Clappr.Player({
            source: data.channel,
            parentId: "#player",
            autoPlay: true,
            mute: false,
            height: "100%",
            width: "100%",
            plugins: [LevelSelector],
            levelSelectorConfig: {
                title: "Çözünürlük",
                labelCallback: fixedQualityLabel
            },
            playback: {
                autoplay: true,
                playInline: true
            }
        });
    })
    .catch(err => {
        document.body.innerHTML = "<h2 style='color:white;text-align:center;margin-top:40vh;'>Yayın yüklenemedi</h2>";
        console.error(err);
    });
</script>

</body>
</html>
